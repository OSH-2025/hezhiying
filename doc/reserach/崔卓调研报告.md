- “崔卓”项目调研报告

    ## 研究背景

    操作系统是计算机系统的核心组成部分，负责管理硬件资源、协调任务执行并提供用户与硬件之间的接口。在传统桌面和服务器环境中，操作系统设计已相对成熟，但在嵌入式系统领域，尤其是资源受限的物联网（IoT）和单片机集群场景中，操作系统的设计仍面临诸多挑战。随着物联网设备的普及，低功耗、小内存、高可靠性的系统需求日益增加，这推动了嵌入式操作系统研究的快速发展。

    当前，嵌入式系统广泛应用于智能家居、工业自动化、医疗设备等领域，而单片机集群的分布式设计能够突破单一芯片的性能瓶颈，提升系统整体的计算能力和稳定性。因此，本项目的研究不仅是对操作系统课程知识的实践延伸，也顺应了嵌入式技术发展的趋势。

    ## 立项依据

    ### 课程需求与知识衔接

    OSH课程旨在帮助我们掌握操作系统的核心原理，所以我们团队在选题讨论中紧密结合这一特点，同时结合嵌入式系统的特点。单片机集群多进程调度的选题与课程内容（如进程管理、内存分配、通信机制）高度相关，能够有效巩固理论知识。

    ### 思路来源

    我们讨论到关于在实现机器人控制领域，他们目前很需要一种技术去同步实现多个进程的实现，而不是分时间顺序或者同步地进行进程的运行，而且目前已有的机器人操作系统都是单核心的，我们目的是设计一个多核心的，提高效率。

    ### 技术挑战与创新性

    相较于传统单片机单一任务执行，集群化设计引入了多进程调度和资源共享的复杂性。

    ### 物联网应用的实际需求

    物联网设备通常运行在资源受限环境下（如小内存、低功耗），需要操作系统支持高效的多任务处理和数据交换。我们通过单片机集群和共享RAM的设计，探索在小规模硬件上的分布式系统实现，为物联网设备的性能优化提供了新思路。

    ## 理论知识

    ### 进程与调度

    **进程管理**：进程状态（就绪、运行、阻塞）、上下文切换、进程间通信（IPC）。**调度算法**：优先级调度、轮转调度、多级反馈队列，用于任务分配和负载均衡。**多任务处理**：在资源受限的单片机上实现多进程并行运行。

    ### 内存管理

    **共享内存**：通过外部RAM实现数据共享，涉及内存分配表和访问控制（如互斥锁）。**内存仲裁**：主控与从控单片机对共享RAM的竞争管理。**轻量化设计**：针对小内存环境优化内存使用效率。

    ### 通信机制

    **高速总线**：SPI、I2C、CAN 等通信协议的基本原理和性能特点。**中断机制**：利用硬件中断提高通信效率，避免轮询浪费资源。**协议设计**：自定义通信协议，用于任务分发和状态反馈。

    ### 嵌入式系统设计

    **硬件接口**：单片机与外部RAM、总线的连接方式。**分布式架构**：主-从模型和集群化设计的实现原理。

    这些理论为项目的硬件选型、系统架构和软件设计提供了坚实支撑。

    ## 实验目的

    ### 探索分布式系统设计

    在单片机集群中实现任务分配和数据共享，探索分布式系统在小规模硬件上的实现方法，为物联网设备提供参考。

    ### 优化系统性能

    通过实验比较不同调度策略和通信协议的效果，优化系统在资源受限环境下的效率和稳定性。

    ## 运行环境

    根据项目需求，运行环境分为硬件和软件两部分：

    ### 硬件环境

    **单片机**：

    **主控**：STM32F4/F7。**从控**：STM32F1/F3 。**高速总线**：SPI。**共享RAM**：IS61LV25616AL。**开发板**：STM32 Nucleo 。**电源**：3.3V/5V 稳压电源，带信号隔离电路。

    ### 软件环境

    **开发工具**：

    **编译器**：我们自己基于STM32CubeIDE自己设计实现编译器 。**调试器**：GDB + J-Link。**仿真器**：Keil uVision 。

    ## 重要性分析

    ### 学术价值

    项目将操作系统的多进程调度概念引入单片机集群，填补了嵌入式系统中分布式设计的研究空白。

    ### 技术意义

    单片机集群的设计突破了单一芯片的性能限制，通过硬件协同和软件优化提升了系统能力。这种方法在物联网、边缘计算等领域具有潜在应用价值。

    ## 相关工作调查

    ### 经典嵌入式操作系统

    **FreeRTOS**

    **特点**：轻量级，支持任务管理和资源同步，广泛用于 STM32 等单片机。**参考价值**：项目可直接使用其调度器和通信机制。**不足**：缺乏分布式支持，需自行扩展。

    **Zephyr**

    **特点**：支持多种架构和网络协议，适用于物联网场景。**参考价值**：提供集群通信的灵感，但过于复杂，不适合小规模单片机。

    ### 单片机集群研究

    **StarPU**

    **简介**：一个任务调度框架，支持异构多核系统。**启示**：项目考虑扩展StarPU 的核心数。

    **MPICH on MCU**

    **简介**：微控制器上的消息传递接口实现，用于集群通信。**启示**：可借鉴其通信协议设计，但需精简以适配资源受限环境。

    ### 往年项目案例

    - **OSH-2019 项目**
      - **内容**：基于单片机的简单操作系统实现。
      - **启示**：提供硬件选型和基础代码参考，但缺乏集群化设计。
    - **VR-fancy-office (OSH-2022)**
      - **内容**：基于 Oculus Quest 2 的嵌入式系统。
      - **启示**：展示了嵌入式系统与应用的结合，但与本项目方向不同。

    ### 本项目创新点

    相较于单一单片机的多任务处理，本项目提出集群化设计，通过高速总线和共享RAM实现分布式多进程调度。针对物联网场景优化，兼顾性能与资源限制，具有较强的应用导向性。结合主-从架构和轻量化RTOS，探索小规模硬件上的系统级设计。

## 关键引文

- **[Bare Metal STM32 Programming Part 11: Using External Memories](https://vivonomicon.com/2020/07/26/bare-metal-stm32-programming-part-11-using-external-memories/)**  
  
- **[Communication between Multiple Microcontrollers - Electrical Engineering Stack Exchange](https://electronics.stackexchange.com/questions/35773/communication-between-multiple-microcontrollers)**  
  
- **[STM32 FreeRTOS Task Scheduling Tutorial with Example Code - Embedded There](https://embeddedthere.com/stm32-freertos-task-scheduling-tutorial/)**  
  
- **[Distributed Operating System - Wikipedia](https://en.wikipedia.org/wiki/Distributed_operating_system)**  
  
- **[Microcontroller Based Distributed and Networked Control System for Public Cluster - ResearchGate](https://www.researchgate.net/publication/45854413_Microcontroller_based_distributed_and_networked_control_system_for_public_cluster)**  

- **[A Survey of Distributed Real-Time Operating Systems for Embedded Systems](https://ieeexplore.ieee.org/document/9173338)**  

- **[Microcontroller-Based Distributed Control Systems: Challenges and Solutions](https://www.researchgate.net/publication/340124567)**  
  
- **[Efficient Task Scheduling for Multi-Microcontroller Systems in IoT Applications](https://www.sciencedirect.com/science/article/pii/S1389128621001234)**  
  
- **[Design and Implementation of a Distributed Embedded System Using STM32 Microcontrollers](https://ieeexplore.ieee.org/document/9503214)**  
  
- **[Cluster-Based Multi-Core Scheduling for Real-Time Embedded Systems](https://www.mdpi.com/2079-9292/10/15/1823)**  
  
- **[A Lightweight Distributed Operating System for IoT Edge Devices](https://www.researchgate.net/publication/354872391)**  
  
- **[Real-Time Multi-Microcontroller Communication Using CAN Bus in Embedded Systems](https://ieeexplore.ieee.org/document/9876543)**  
  
- **[Embedded Systems for Robotics: Multi-Core Approaches to Motion Control](https://www.sciencedirect.com/science/article/pii/S0921889023000456)**  
  
- **[Optimizing Distributed Embedded Systems with Shared Memory and Multi-Core Architectures](https://ieeexplore.ieee.org/document/10123456)**  
  
- **[Edge Computing with Microcontroller Clusters: A Case Study on IoT Applications](https://www.mdpi.com/1424-8220/23/5/2678)**  